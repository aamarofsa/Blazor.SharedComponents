@page "/product-list"
@using Base.Models;

<PageTitle>Products List</PageTitle>

<FSA_GenericList @ref=MyGrid Items="Products" GenericData="GenericListData" ReturnToAction="@((args)=> ReturnToAction(args.Item1, args.Item2))" />

@code {
    private FSA_GenericList<Product> MyGrid;

    private List<Product>? Products { get; set; } = new();

    private GenericListData GenericListData { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        Products = new List<Product>
        {
            new Product
            {
                Id = 1,
                Name = "Pan",
            },
            new Product
            {
                Id = 2,
                Name = "Papas",
            },
            new Product
            {
                Id = 3,
                Name = "Frijoles",
            },
            new Product
            {
                Id = 4,
                Name = "Azucar",
            },
            new Product
            {
                Id = 5,
                Name = "Sal",
            },
            new Product
            {
                Id = 6,
                Name = "Coco",
            },
            new Product
            {
                Id = 7,
                Name = "Aceite",
            },
            new Product
            {
                Id = 8,
                Name = "Tomates",
            },
            new Product
            {
                Id = 9,
                Name = "Pescado",
            },
            new Product
            {
                Id = 10,
                Name = "Jamón",
            },
            new Product
            {
                Id = 11,
                Name = "Pollo",
            },
            new Product
            {
                Id = 12,
                Name = "Chicharo",
            },
            new Product
            {
                Id = 13,
                Name = "Vinagre",
            },
            new Product
            {
                Id = 14,
                Name = "Huevos",
            },
        };

        GenericListData = new GenericListData()
            {
                SelectionMode = SelectionMode.Single,
                AllowMultiColumnSorting = false,
                AllowFiltering = true,
                AllowAlternatingRows = true,
                AllowPaging = true,
                PageSize = 10,
                AllowActions = false,
                DataColumns = new List<DataColumn>
                {
                    new DataColumn
                    {
                        Property = nameof(Product.Id),
                        Title = "ID",
                        Sortable = true,
                        Pickable = false,
                        Frozen = true,
                        Width = "80px",
                    },
                    new DataColumn
                    {
                        Property = nameof(Product.Name),
                        Title = "PRODUCT NAME",
                        Filterable = true,
                        Sortable = true,
                    }
                },
        };
    }

    public void ReturnToAction(string action, Object item)
    {
        try
        {
            if (action == "delete")
            {
                var product = item as Product;
                Products.Remove(product);

                Console.WriteLine(action);
            }
            if (action == "edit")
            {
                Console.WriteLine(action);
            }

            MyGrid.MyGrid.Reload();
        }
        catch (Exception)
        {
        }
    }
}
